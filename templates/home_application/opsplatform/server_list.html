<%inherit file="base.html"/>
<%block name="content">
<link href="${STATIC_URL}opsplatform/css/dataTables.bootstrap.css" rel="stylesheet"/>
<link href="${STATIC_URL}opsplatform/css/bk.css?v=1.0.1" rel="stylesheet">
<script src="${STATIC_URL}opsplatform/js/jquery-1.10.2.min.js"></script>
<script src="${STATIC_URL}opsplatform/js/jquery.dataTables.js"></script>
<script src="${STATIC_URL}opsplatform/js/dataTables.bootstrap.js"></script>
<script src="${STATIC_URL}opsplatform/js/sweetalert.min.js"></script>
<link rel="stylesheet" type="text/css" href="${STATIC_URL}opsplatform/css/sweetalert.css">
<script src="${STATIC_URL}js/csrftoken.js"></script>

            <div class="row wrapper border-bottom white-bg page-heading">
                <div class="col-lg-8">
                    <h2>资产管理</h2>
                    <ol class="breadcrumb">
                        <li>
                            <a href="${SITE_URL}">Dashboard</a>
                        </li>
                        
                        <li class="active">
                            <strong>服务器列表</strong>
                        </li>
                    </ol>
                </div>
               
            </div>
            <!--  -->
        <div class="wrapper wrapper-content animated fadeInRight">
            <div class="row">
                <div class="col-lg-12">
                    <div class="ibox float-e-margins">
                    
                        <div class="ibox-content">
                            <div id="ct-chart1" class="ct-perfect-fourth"></div>
                            
            <table class="table table-bordered table7_demo" id="table2_demo1">
                <thead>

                    <tr>
                    % for tit in title:
                        <th>${tit}</th>
                        % endfor

                    </tr>
                </thead>
                <tbody>
                    % for dd in data:
                    <tr>
                        <td>${dd['id']}</td>
                        <td>${dd['hostname']}</td>
                        <td>${dd['private_ip']}</td>
                        <td>${dd['public_ip']}</td>
                        <td>${dd['mem_total']} M</td>
                        <td>${dd['cpu_type']}</td>
                        <td>${dd['num_cpus']}</td>
                        <td>${dd['os_release']}</td>
                        <td>${dd['kernelrelease']}</td>                  
                       <td>
                            <button class="btn btn-xs btn-primary">连接</button>
                            <button class="btn btn-xs btn-success">详情</button>
                            <input type="button" class="btn btn-xs btn-danger" check_id="${dd['id']}" name="${dd['hostname']}" value="删除" onclick="del_raw()">
                        </td>   
                    </tr>
                % endfor
                </tbody>
            </table>
                        </div>
                    </div>
                </div>
            
            </div>
    
        </div>

<script>
 function del_raw() {
    var hostname = $("input:button").attr("name");
    var check_id = $("input:button").attr("check_id");
    // alert(check_id)
    swal({
      title: "您确定要删除主机"  + hostname + "？",
      text: "删除后将无法恢复，请谨慎操作！",
      type: "warning",
       
      showCancelButton: true,
      showLoaderOnConfirm: true,
      confirmButtonColor: "#DD6B55",
      confirmButtonText: "是的，删除它",
      cancelButtonText: "我在想想吧...",
      closeOnConfirm: false,
      closeOnCancel: true  //关闭取消后还弹出让你确认的效果提示
    },
      function(isConfirm){

      if (isConfirm) {    // 如果确认就会去携带者hostname去后台处理
        $.ajax ({
                type:'post',
                url:"${SITE_URL}delete_server/?host="+hostname,
                success:function(res){   //将处理的结果进行判断，根据执行失败，成功现实的提示不同的内容
                    if (res.result) {
                        swal(res.message, "Your imaginary file has been deleted.", "success");
                        $("input[check_id="+check_id+"]").parents("tr").remove(); //获取要删除的那行节点
                    }
                    else {
                        swal(res.message, "Your imaginary file is safe :)", "error");
                    }
                }
            });           
      } 
      else {
        swal("您已经取消操作...", "Your imaginary file is safe :)", "info");
      }
    });

}
</script>


    <script type="text/javascript">
//表格(DataTables)-1，html数据源
        var language = {
          search: '搜索：',
          lengthMenu: "每页显示 _MENU_ 记录",
          zeroRecords: "没找到相应的数据！",
          info: "分页 _PAGE_ / _PAGES_",
          infoEmpty: "暂无数据！",
          infoFiltered: "(从 _MAX_ 条数据中搜索)",
          paginate: {
            first: '首页',
            last: '尾页',
            previous: '上一页',
            next: '下一页',
          }
        }

        $('#table2_demo1').dataTable({
          paging: true, //隐藏分页
          ordering: true, //关闭排序
          info: true, //隐藏左下角分页信息
          searching: true, //关闭搜索
          pageLength : 10, //每页显示几条数据
          lengthChange: true, //不允许用户改变表格每页显示的记录数
          language: language //汉化
        });
        </script>
   
</%block>

